{"version":3,"sources":["webpack:///src/environments/environment.ts","webpack:///src/app/hacker-news.service.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.component.ts","webpack:///src/app/app.module.ts","webpack:///src/app/infinite-scroller.directive.ts","webpack:///src/main.ts","webpack:///$_lazy_route_resource lazy namespace object"],"names":["environment","production","BASE_URL","HackerNewsService","http","page","get","AppComponent","service","title","currentPage","news","config","scrollCallback","getStories","bind","getLatestStories","pipe","processData","console","log","concat","DEFAULT_PERFECT_SCROLLBAR_CONFIG","suppressScrollX","AppModule","provide","useValue","DEFAULT_SCROLL_POSITION","sH","sT","cH","InfiniteScrollerDirective","elm","scrollPercent","isUserScrollingDown","positions","isScrollExpectedPercent","position","registerScrollEvent","streamScrollEvents","requestCallbackOnScroll","requestOnScrollSubscription","unsubscribe","scrollEvent$","nativeElement","userScrolledDown$","scrollData","target","clientHeight","scrollHeight","scrollTop","requestOnScroll$","immediateCallback","subscribe","bootstrapModule","err","error","webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id"],"mappings":"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","file":"main-es5.js","sourcesContent":["// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\nconst BASE_URL = 'http://node-hnapi.herokuapp.com';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class HackerNewsService {\r\n  constructor(private http: HttpClient) {}\r\n\r\n  getLatestStories(page: number = 1) {\r\n    return this.http.get(`${BASE_URL}/news?page=${page}`);\r\n  }\r\n}\r\n","<div class=\"content\">\r\n  <span>infinite-scroller-poc app is running!</span>\r\n</div>\r\n\r\n<ul id=\"infinite-scroller\"\r\n    appInfiniteScroller\r\n    scrollPerecnt=\"70\"\r\n    immediateCallback=\"true\"\r\n    [scrollCallback]=\"scrollCallback\">\r\n  <li class=\"item\"\r\n      *ngFor=\"let item of news\">{{item.title}} </li>\r\n</ul>","import { Component, OnInit } from '@angular/core';\r\nimport { HackerNewsService } from './hacker-news.service';\r\nimport { tap } from 'rxjs/operators';\r\nimport { PerfectScrollbarConfigInterface } from 'ngx-perfect-scrollbar';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss'],\r\n})\r\nexport class AppComponent implements OnInit {\r\n  title = 'infinite-scroller-poc';\r\n\r\n  currentPage = 1;\r\n\r\n  news: Array<any> = [];\r\n\r\n  scrollCallback;\r\n\r\n  config: PerfectScrollbarConfigInterface = {};\r\n\r\n  constructor(private service: HackerNewsService) {\r\n    this.scrollCallback = this.getStories.bind(this);\r\n  }\r\n\r\n  getStories() {\r\n    return this.service\r\n      .getLatestStories(this.currentPage)\r\n      .pipe(tap(this.processData.bind(this)));\r\n  }\r\n\r\n  private processData(news: any[]) {\r\n    console.log('here is am 2', news);\r\n\r\n    this.currentPage++;\r\n    this.news = this.news.concat(news);\r\n  }\r\n\r\n  async ngOnInit() {}\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppComponent } from './app.component';\r\nimport { InfiniteScrollerDirective } from './infinite-scroller.directive';\r\nimport { HttpClientModule } from '@angular/common/http';\r\n\r\nimport { PerfectScrollbarModule } from 'ngx-perfect-scrollbar';\r\nimport { PERFECT_SCROLLBAR_CONFIG } from 'ngx-perfect-scrollbar';\r\n\r\nimport { PerfectScrollbarConfigInterface } from 'ngx-perfect-scrollbar';\r\n\r\nconst DEFAULT_PERFECT_SCROLLBAR_CONFIG: PerfectScrollbarConfigInterface = {\r\n  suppressScrollX: true,\r\n};\r\n\r\n@NgModule({\r\n  declarations: [AppComponent, InfiniteScrollerDirective],\r\n  imports: [BrowserModule, HttpClientModule, PerfectScrollbarModule],\r\n  providers: [\r\n    {\r\n      provide: PERFECT_SCROLLBAR_CONFIG,\r\n      useValue: DEFAULT_PERFECT_SCROLLBAR_CONFIG,\r\n    },\r\n  ],\r\n  bootstrap: [AppComponent],\r\n})\r\nexport class AppModule {}\r\n","import {\r\n  Directive,\r\n  Input,\r\n  ElementRef,\r\n  AfterViewInit,\r\n  OnDestroy,\r\n} from '@angular/core';\r\nimport { Observable, fromEvent, pipe, Subscription } from 'rxjs';\r\n\r\nimport { map, pairwise, filter, startWith, exhaustMap } from 'rxjs/operators';\r\n\r\ninterface ScrollPosition {\r\n  sH: number;\r\n  sT: number;\r\n  cH: number;\r\n}\r\n\r\nconst DEFAULT_SCROLL_POSITION: ScrollPosition = {\r\n  sH: 0,\r\n  sT: 0,\r\n  cH: 0,\r\n};\r\n\r\n@Directive({\r\n  selector: '[appInfiniteScroller]',\r\n})\r\nexport class InfiniteScrollerDirective implements AfterViewInit, OnDestroy {\r\n  private scrollEvent$: Observable<MouseEvent>;\r\n\r\n  private userScrolledDown$: Observable<any>;\r\n\r\n  private requestStream$: Observable<any>;\r\n\r\n  private requestOnScroll$: Observable<any>;\r\n  requestOnScrollSubscription: Subscription;\r\n\r\n  constructor(private elm: ElementRef) {}\r\n\r\n  @Input()\r\n  scrollCallback;\r\n\r\n  @Input()\r\n  immediateCallback;\r\n\r\n  @Input()\r\n  scrollPercent = 70;\r\n\r\n  ngAfterViewInit() {\r\n    this.registerScrollEvent();\r\n\r\n    this.streamScrollEvents();\r\n\r\n    this.requestCallbackOnScroll();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.requestOnScrollSubscription) {\r\n      this.requestOnScrollSubscription.unsubscribe();\r\n      this.requestOnScrollSubscription = null;\r\n    }\r\n  }\r\n\r\n  private registerScrollEvent() {\r\n    this.scrollEvent$ = fromEvent(this.elm.nativeElement, 'scroll');\r\n  }\r\n\r\n  private streamScrollEvents() {\r\n    this.userScrolledDown$ = this.scrollEvent$.pipe(\r\n      map(\r\n        (scrollData) =>\r\n          ({\r\n            cH: (scrollData.target as HTMLElement).clientHeight,\r\n            sH: (scrollData.target as HTMLElement).scrollHeight,\r\n            sT: (scrollData.target as HTMLElement).scrollTop,\r\n          } as ScrollPosition)\r\n      ),\r\n      pairwise(),\r\n      filter(\r\n        (positions) =>\r\n          this.isUserScrollingDown(positions) &&\r\n          this.isScrollExpectedPercent(positions[1])\r\n      )\r\n    );\r\n  }\r\n\r\n  private requestCallbackOnScroll() {\r\n    this.requestOnScroll$ = this.userScrolledDown$;\r\n\r\n    if (this.immediateCallback) {\r\n      this.requestOnScroll$ = this.requestOnScroll$.pipe(\r\n        startWith([DEFAULT_SCROLL_POSITION, DEFAULT_SCROLL_POSITION])\r\n      );\r\n    }\r\n\r\n    this.requestOnScrollSubscription = this.requestOnScroll$\r\n      .pipe(exhaustMap(() => this.scrollCallback && this.scrollCallback()))\r\n      .subscribe(() => {});\r\n  }\r\n\r\n  private isUserScrollingDown = (positions) => {\r\n    return positions[0].sT < positions[1].sT;\r\n  }\r\n\r\n  private isScrollExpectedPercent = (position) => {\r\n    return (position.sT + position.cH) / position.sH > this.scrollPercent / 100;\r\n  }\r\n}\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"]}